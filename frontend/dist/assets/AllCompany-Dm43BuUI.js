import{u as H,a as O,r as o,j as e,b as g,B as m}from"./index-B7OZzBRK.js";import{T as R}from"./Table-C0LzT_QR.js";import{T as G,O as C,a as S}from"./TablePlaceholder-CtzLlF3u.js";import{M as K}from"./Modal-BBnWcCLm.js";import{C as Q}from"./Toast-C-pLTZpU.js";import"./ThemeProvider-mjo_KbZQ.js";import"./index-DNKZOxsO.js";import"./warning-KWRHVkjh.js";import"./TransitionWrapper-qWTe5h-w.js";import"./useEventCallback-DsMNjBTY.js";import"./Placeholder-DGZdzl_d.js";import"./Col-DXoX1HGj.js";import"./Button-5FLJvNMB.js";import"./Button-DQAcu0VB.js";function ce(){document.title="CPMS | All Company";const h=H(),D=O(),[T,$]=o.useState(!0),[c,E]=o.useState({}),[f,M]=o.useState({}),[p,k]=o.useState({companyName:"",companyId:""}),[A,n]=o.useState(!1),[_,i]=o.useState(""),[B,x]=o.useState(!1),[u,P]=o.useState(""),I=async()=>{var t;try{const l=localStorage.getItem("token"),s=await g.get(`${m}/user/detail`,{headers:{Authorization:`Bearer ${l}`}});s!=null&&s.data&&P((t=s==null?void 0:s.data)==null?void 0:t.role)}catch(l){console.log("Account.jsx => ",l)}},j=async()=>{var t,l;try{const s=localStorage.getItem("token"),r=await g.get(`${m}/company/company-detail`,{headers:{Authorization:`Bearer ${s}`}});E(r.data.companys),$(!1)}catch(s){console.log("Error fetching jobs ",s),(l=(t=s==null?void 0:s.response)==null?void 0:t.data)!=null&&l.msg&&(i(s.response.data.msg),n(!0))}},L=(t,l)=>{k({companyId:l,companyName:t}),x(!0)},z=async t=>{var l,s,r,N,y,w,v;console.log("Deleting company with ID:",t);try{const a=localStorage.getItem("token");if(!a){i("Authentication required. Please login again."),n(!0),x(!1);return}console.log("Sending delete request to:",`${m}/company/delete-company`);const d=await g.post(`${m}/company/delete-company`,{companyId:t},{headers:{Authorization:`Bearer ${a}`}});console.log("Delete response:",d.data),x(!1),(l=d==null?void 0:d.data)!=null&&l.msg&&(i((s=d==null?void 0:d.data)==null?void 0:s.msg),n(!0)),await j()}catch(a){console.error("Error deleting company => ",a),console.error("Error response:",(r=a==null?void 0:a.response)==null?void 0:r.data),x(!1),(y=(N=a==null?void 0:a.response)==null?void 0:N.data)!=null&&y.msg?i((v=(w=a==null?void 0:a.response)==null?void 0:w.data)==null?void 0:v.msg):a!=null&&a.message?i(`Error: ${a.message}`):i("Failed to delete company. Please try again."),n(!0)}},F=async()=>{var t,l;try{const s=await g.get(`${m}/tpo/jobs`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});M(s.data.data)}catch(s){console.log("Error fetching jobs ",s),(l=(t=s==null?void 0:s.response)==null?void 0:t.data)!=null&&l.msg&&(i(s.response.data.msg),n(!0))}},U=t=>e.jsx(S,{id:"button-tooltip",...t,children:"Delete Company"}),q=t=>e.jsx(S,{id:"button-tooltip",...t,children:"Edit Company"}),J=()=>x(!1),{showToastPass:b,toastMessagePass:W}=D.state||{showToastPass:!1,toastMessagePass:""};return o.useEffect(()=>{b&&(i(W),n(b),h(".",{replace:!0,state:{}})),I(),j(),F()},[]),e.jsx(e.Fragment,{children:e.jsxs(e.Fragment,{children:[e.jsx(Q,{show:A,onClose:()=>n(!1),message:_,delay:3e3,position:"bottom-end"}),e.jsx("div",{className:"",children:T?e.jsx(G,{}):e.jsx("div",{className:"overflow-hidden rounded-lg shadow-lg border border-gray-200 my-6",children:e.jsxs(R,{hover:!0,responsive:"sm",className:"mb-0 bg-white w-full text-base max-sm:text-sm",children:[e.jsx("thead",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-sm font-semibold",style:{width:"7%"},children:"Sr. No."}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold",style:{width:"18%"},children:"Company Name"}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold",style:{width:"15%"},children:"Website"}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold",style:{width:"15%"},children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold",style:{width:"17%"},children:"Difficulty"}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold text-center",style:{width:"13%"},children:"Jobs Posted"}),e.jsx("th",{className:"px-4 py-3 text-sm font-semibold text-center",style:{width:"15%"},children:"Action"})]})}),e.jsx("tbody",{className:"bg-white",children:(c==null?void 0:c.length)>0?c==null?void 0:c.map((t,l)=>{var s;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-indigo-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:l+1}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-building text-indigo-600 text-xs"}),e.jsx("span",{className:"font-semibold text-gray-800",children:t==null?void 0:t.companyName})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("a",{href:t==null?void 0:t.companyWebsite,target:"_blank",className:"text-indigo-600 hover:text-indigo-800 no-underline flex items-center gap-1",rel:"noopener noreferrer",children:[e.jsx("i",{className:"fa-solid fa-globe text-xs"}),t==null?void 0:t.companyWebsite]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-location-dot text-xs text-gray-400"}),t==null?void 0:t.companyLocation]})}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[(t==null?void 0:t.companyDifficulty)==="Easy"&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-semibold",children:[e.jsx("i",{className:"fa-solid fa-circle-check"}),"Easy"]}),(t==null?void 0:t.companyDifficulty)==="Moderate"&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-xs font-semibold",children:[e.jsx("i",{className:"fa-solid fa-circle-minus"}),"Moderate"]}),(t==null?void 0:t.companyDifficulty)==="Hard"&&e.jsxs("span",{className:"inline-flex items-center gap-1 bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-semibold",children:[e.jsx("i",{className:"fa-solid fa-circle-xmark"}),"Hard"]})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-10 h-10 bg-purple-100 text-purple-600 rounded-full font-bold",children:f.length?(s=f==null?void 0:f.filter(r=>(r==null?void 0:r.company)==(t==null?void 0:t._id)))==null?void 0:s.length:"0"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx(C,{placement:"top",delay:{show:250,hide:400},overlay:q,children:e.jsx("button",{className:"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-600 hover:text-white transition-all",children:e.jsx("i",{className:"fa-solid fa-pen-to-square text-base cursor-pointer",onClick:()=>{u==="tpo_admin"?h(`../tpo/add-company/${t._id}`):u==="management_admin"?h(`../management/add-company/${t._id}`):u==="superuser"&&h(`../admin/add-company/${t._id}`)}})})}),e.jsx(C,{placement:"top",delay:{show:250,hide:400},overlay:U,children:e.jsx("button",{className:"p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-600 hover:text-white transition-all",children:e.jsx("i",{className:"fa-solid fa-trash-can text-base cursor-pointer",onClick:()=>L(t==null?void 0:t.companyName,t==null?void 0:t._id)})})})]})})]},t==null?void 0:t._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-building-slash text-4xl text-gray-300"}),e.jsx("p",{className:"mb-0 font-medium",children:"No Companies Found"})]})})})})]})})}),e.jsx(K,{show:B,close:J,header:"Confirmation",body:`Do you want to delete company ${p.companyName}?`,btn:"Delete",confirmAction:()=>z(p.companyId)})]})})}export{ce as default};
