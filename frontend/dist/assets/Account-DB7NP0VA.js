import{r as u,j as e,b as g,B as f}from"./index-B3aSgIEu.js";import{B as _}from"./index-Un8PM_rs.js";import{R as C}from"./index-BQHwBMOM.js";import{a as y}from"./index-BJeRoox1.js";import{a as l,F as n}from"./Form-D7tsfd2t.js";import{C as M}from"./Toast-DNXJp6MA.js";import"./ThemeProvider-COntGE-K.js";import"./index-_BQgUFlf.js";import"./warning-Bnkvw9rZ.js";import"./Col-Cd-x-5D5.js";function G(){var v,N;document.title="CPMS | Account";const[s,x]=u.useState({}),[P,b]=u.useState(!0),p=async()=>{try{const a=localStorage.getItem("token"),o=await g.get(`${f}/user/detail`,{headers:{Authorization:`Bearer ${a}`}});x(o.data),b(!1)}catch(a){console.log("Account.jsx => ",a),b(!1)}},d=a=>x({...s,[a.target.name]:a.target.value}),w=async a=>{var o;a.preventDefault();try{const r=localStorage.getItem("token"),m=await g.post(`${f}/user/update-profile`,s,{headers:{Authorization:`Bearer ${r}`}});c(m.data.msg),i(!0)}catch(r){(o=r==null?void 0:r.response.data)!=null&&o.msg?c(r.response.data.msg):c(r.message),i(!0),console.log("handleBasicDetailSubmit => ",r)}finally{p()}},A=async a=>{const o=a.target.files[0];if(o){const r=new FormData;r.append("profileImgs",o),r.append("userId",s.id);try{const m=await g.post(`${f}/user/upload-photo`,r);c(m.data.msg),i(!0)}catch(m){c(m.message),i(!0),console.error("Error uploading photo:",m)}finally{console.log("runnned"),p()}}},[S,i]=u.useState(!1),[F,c]=u.useState(""),[t,h]=u.useState({oldpass:"",newpass:"",newcfmpass:"",error:""});function I(a){return/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(a)}const j=a=>{h({...t,[a.target.name]:a.target.value})},B=async a=>{if(a.preventDefault(),!t.oldpass||!t.newpass||!t.newcfmpass)return h({...t,error:"All Field Requied!"});if(!I(t==null?void 0:t.newpass))return h({...t,error:"Password Must Contains: Minimum 8 Char with atleast 1 Special Char, 1 Number, 1 Uppercase, 1 Lowercase"});if(t.newpass!=t.newcfmpass)return h({...t,error:"New Password & Confirm New Password Didn't Matched"});try{const o=localStorage.getItem("token"),r=await g.post(`${f}/user/change-password`,t,{headers:{Authorization:`Bearer ${o}`}});r!=null&&r.data&&(c(r==null?void 0:r.data),i(!0))}catch(o){console.log("Account.jsx updatepass =>",o),h({...t,error:o.message})}finally{p()}},D=a=>!a||a==="undefined"?"":new Date(a).toISOString().split("T")[0];return u.useEffect(()=>{p()},[]),e.jsx(e.Fragment,{children:P?e.jsx("div",{className:"flex justify-center h-72 items-center",children:e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-3xl"})}):e.jsxs(e.Fragment,{children:[e.jsx(M,{show:S,onClose:()=>i(!1),message:F,delay:3e3,position:"bottom-end"}),e.jsx("div",{className:"max-sm:text-sm text-base",children:e.jsxs("div",{className:"container grid grid-cols-3 gap-3 p-4 max-lg:grid-cols-2 max-sm:grid-cols-1",children:[e.jsxs("div",{className:"col-span-2 bg-white/90 border-2 border-indigo-200 p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:e.jsx("i",{className:"fa-solid fa-user text-indigo-600 text-xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Personal Information"})]}),e.jsxs(l,{onSubmit:w,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2  justify-center items-start",children:[e.jsx(n,{label:"First Name",children:e.jsx(l.Control,{type:"text",autoComplete:"first_name",placeholder:"First Name",name:"first_name",value:s.first_name||"",onChange:d,required:!0})}),e.jsx(n,{label:"Middle Name",children:e.jsx(l.Control,{type:"text",autoComplete:"middle_name",placeholder:"Middle Name",name:"middle_name",value:s.middle_name||"",onChange:d,required:!0})}),e.jsx(n,{label:"Last Name",children:e.jsx(l.Control,{type:"text",autoComplete:"last_name",placeholder:"Last Name",name:"last_name",value:s.last_name||"",onChange:d,required:!0})}),e.jsx(n,{label:"Number",children:e.jsx(l.Control,{type:"number",autoComplete:"number",placeholder:"Number",name:"number",value:s.number||"",onChange:d,onInput:a=>{a.target.value.length>10&&(a.target.value=a.target.value.slice(0,10))},required:!0})}),e.jsx("div",{className:"col-span-2",children:e.jsx(n,{label:"Email",children:e.jsx(l.Control,{type:"email",autoComplete:"email",placeholder:"Email",name:"email",value:s.email||"",onChange:d,required:!0})})}),e.jsx(n,{controlId:"floatingBirthDate",label:"Date of Birth",children:e.jsx(l.Control,{type:"date",placeholder:"Date of Birth",name:"dateOfBirth",value:D(s==null?void 0:s.dateOfBirth),onChange:d,required:!0})}),e.jsx(n,{controlId:"floatingSelectGender",label:"Gender",children:e.jsxs(l.Select,{"aria-label":"Floating label select gender",className:"cursor-pointer",name:"gender",value:(s==null?void 0:s.gender)===void 0?"undefined":s==null?void 0:s.gender,onChange:d,children:[e.jsx("option",{disabled:!0,value:"undefined",className:"text-gray-400",children:"Enter Your Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})})]}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 my-4 px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300",children:[e.jsx(_,{}),"Save Changes"]})]})]}),e.jsxs("div",{className:"bg-white/90 border-2 border-green-200 p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 w-full max-sm:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:e.jsx(y,{className:"text-green-600 text-xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Address Details"})]}),e.jsxs(l,{onSubmit:w,children:[e.jsxs("div",{className:"grid gap-2 ",children:[e.jsx(n,{className:"w-full",controlId:"floatingTextareaAddress",label:"Address",children:e.jsx(l.Control,{as:"textarea",placeholder:"Enter Full Address here...",style:{height:"150px",resize:"none"},name:"address",value:(v=s==null?void 0:s.fullAddress)==null?void 0:v.address,onChange:a=>{x({...s,fullAddress:{...s==null?void 0:s.fullAddress,address:a.target.value}})},required:!0})}),e.jsx(n,{controlId:"floatingAddressPincode",label:"Pincode",children:e.jsx(l.Control,{type:"number",placeholder:"Pincode",maxLength:6,name:"pincode",value:(N=s==null?void 0:s.fullAddress)==null?void 0:N.pincode,onChange:a=>{x({...s,fullAddress:{...s==null?void 0:s.fullAddress,pincode:a.target.value}})},pattern:"\\d{6}",onInput:a=>{a.target.value.length>6&&(a.target.value=a.target.value.slice(0,6))},required:!0})})]}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 my-4 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300",children:[e.jsx(y,{}),"Update Address"]})]})]}),e.jsxs("div",{className:"bg-white/90 border-2 border-blue-200 p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 w-full max-sm:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:e.jsx("i",{className:"fa-solid fa-camera text-blue-600 text-xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Profile Photo"})]}),e.jsx("div",{className:"",children:e.jsxs(l,{className:"flex flex-col justify-center items-center gap-3 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.profile,alt:"Profile Img",width:"150",height:"150",className:"rounded-full border-4 border-blue-200 shadow-lg"}),e.jsx("div",{className:"absolute bottom-0 right-0 p-2 bg-blue-600 rounded-full",children:e.jsx("i",{className:"fa-solid fa-camera text-white text-sm"})})]}),e.jsxs(l.Group,{controlId:"formFile",className:"mb-3 text-xl",onChange:A,children:[e.jsx(l.Label,{children:s.first_name+" "+s.middle_name+" "+s.last_name}),e.jsx(l.Control,{type:"file",accept:".jpg, .jpeg, .png"})]})]})})]}),e.jsxs("div",{className:"bg-white/90 border-2 border-orange-200 p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 w-full col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:e.jsx(C,{className:"text-orange-600 text-xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Change Password"})]}),e.jsxs(l,{onSubmit:B,children:[e.jsxs("div",{className:"grid gap-2 ",children:[e.jsx(n,{label:"Current Password",children:e.jsx(l.Control,{type:"password",autoComplete:"password",placeholder:"Password",name:"oldpass",value:t.oldpass||"",onChange:j})}),e.jsx(n,{label:"New Password",children:e.jsx(l.Control,{type:"password",autoComplete:"password",placeholder:"New Password",name:"newpass",value:t.newpass||"",onChange:j})}),e.jsx(n,{label:"Confirm New Password",children:e.jsx(l.Control,{type:"password",autoComplete:"password",placeholder:"Confirm New Password",name:"newcfmpass",value:t.newcfmpass||"",onChange:j})})]}),(t==null?void 0:t.error)&&e.jsx("div",{className:"",children:e.jsx("span",{className:"text-red-500",children:t==null?void 0:t.error})}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 my-4 px-6 py-3 bg-gradient-to-r from-orange-600 to-red-600 text-white font-semibold rounded-lg shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300",children:[e.jsx(C,{}),"Update Password"]})]})]})]})})]})})}export{G as default};
