import{r as t,j as s,b as i,B as c}from"./index-B3aSgIEu.js";import{A as $}from"./AddUserTable-DEax5Ftq.js";import{C as j}from"./Toast-DNXJp6MA.js";import{M as b}from"./Modal-y_Bwdyn3.js";import"./Table-D7p0oCGX.js";import"./ThemeProvider-COntGE-K.js";import"./TablePlaceholder-BPNYtZh7.js";import"./index-_BQgUFlf.js";import"./warning-Bnkvw9rZ.js";import"./TransitionWrapper-Bf0TK5bL.js";import"./useEventCallback-BQ8UfDmj.js";import"./Placeholder-Dt8gjBXH.js";import"./Col-Cd-x-5D5.js";import"./Button-VxBu_kGs.js";import"./Button-DOHxPqx8.js";function O(){document.title="CPMS | Approve Students";const[g,A]=t.useState([]),[y,v]=t.useState(!0),[w,r]=t.useState(!1),[x,a]=t.useState(""),[u,o]=t.useState(!1),[n,l]=t.useState(null),[U,p]=t.useState(""),[m,f]=t.useState(""),d=async()=>{try{const e=await i.get(`${c}/admin/student-users`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.data){const D=e.data.studentUsers.filter(E=>!E.studentProfile.isApproved);A(D)}else console.warn("Response does not contain studentUsers:",e.data)}catch(e){console.error("Error fetching user details",e)}finally{v(!1)}};t.useEffect(()=>{d()},[]);const B=e=>{l(e),p(`Do you want to delete ${e}?`),f("Delete"),o(!0)},h=async()=>{try{const e=await i.post(`${c}/admin/student-delete-user`,{email:n},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});o(!1),e.data&&(a(e.data.msg),r(!0),d())}catch(e){console.log("student => confirmDelete ==> ",e)}},S=()=>{o(!1),l(null)},M=e=>{l(e),p(`Do you want to approve ${e}?`),f("Approve"),o(!0)},T=async()=>{try{const e=await i.post(`${c}/admin/student-approve`,{email:n},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e.data&&(a(e.data.msg||"User approved successfully"),r(!0),d()),o(!1)}catch(e){a("Error approving user"),r(!0),console.log("handleApproveStudent => AddUersTable.jsx ==> ",e)}};return s.jsxs(s.Fragment,{children:[s.jsx(j,{show:w,onClose:()=>r(!1),message:x,delay:3e3,position:"bottom-end"}),s.jsx($,{users:g,loading:y,handleDeleteUser:B,showModal:u,closeModal:S,confirmDelete:h,userToDelete:n,userToAdd:"approve-student",handleApproveStudent:M}),s.jsx(b,{show:u,close:S,header:"Confirmation",body:U,btn:m,confirmAction:m==="Delete"?h:T})]})}export{O as default};
