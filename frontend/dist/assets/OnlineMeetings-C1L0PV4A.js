import{r as l,b as h,B as x,j as e}from"./index-B7OZzBRK.js";import{r as c,w as E,t as I,u as L,x as B}from"./index-eTNoQcu-.js";function _(){const[b,v]=l.useState([]),[S,r]=l.useState(!1),[o,g]=l.useState(!1),[d,n]=l.useState({type:"",text:""}),[k,j]=l.useState(!1),[C,N]=l.useState(""),[p,y]=l.useState(""),[t,i]=l.useState({title:"",description:"",scheduledTime:"",duration:60});l.useEffect(()=>{m()},[]);const m=async()=>{try{const s=localStorage.getItem("token"),a=await h.get(`${x}/meeting/tpo/all`,{headers:{Authorization:`Bearer ${s}`}});a.data.success&&v(a.data.meetings)}catch(s){console.error("Error fetching meetings:",s)}},w=async s=>{var a,f;s.preventDefault(),g(!0),n({type:"",text:""});try{const u=localStorage.getItem("token"),$=new Date(t.scheduledTime),A={...t,scheduledTime:$.toISOString()};(await h.post(`${x}/meeting/create`,A,{headers:{Authorization:`Bearer ${u}`}})).data.success&&(n({type:"success",text:"Meeting created! Email invitations sent to all students."}),r(!1),i({title:"",description:"",scheduledTime:"",duration:60}),m())}catch(u){n({type:"error",text:((f=(a=u.response)==null?void 0:a.data)==null?void 0:f.message)||"Failed to create meeting"})}finally{g(!1)}},M=async s=>{if(window.confirm("Delete this meeting?"))try{const a=localStorage.getItem("token");await h.delete(`${x}/meeting/tpo/${s}`,{headers:{Authorization:`Bearer ${a}`}}),n({type:"success",text:"Meeting deleted"}),m()}catch{n({type:"error",text:"Failed to delete meeting"})}},T=s=>new Date(s).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short",timeZone:"Asia/Kolkata"}),D=(s,a)=>{N(s),y(a),j(!0)},F=()=>{j(!1),N(""),y("")};return e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("h3",{className:"mb-0",children:[e.jsx(c,{className:"me-2 text-primary"}),"Online Meetings"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>r(!0),children:[e.jsx(E,{className:"me-2"}),"Schedule Meeting"]})]}),d.text&&e.jsxs("div",{className:`alert alert-${d.type==="success"?"success":"danger"} alert-dismissible fade show`,role:"alert",children:[d.text,e.jsx("button",{type:"button",className:"btn-close",onClick:()=>n({type:"",text:""})})]}),e.jsx("div",{className:"row g-3",children:b.length===0?e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card text-center py-5",children:e.jsxs("div",{className:"card-body",children:[e.jsx(c,{size:48,className:"text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No meetings scheduled"}),e.jsx("p",{className:"text-muted",children:"Click 'Schedule Meeting' to create your first meeting"})]})})}):b.map(s=>e.jsx("div",{className:"col-md-6 col-lg-4",children:e.jsx("div",{className:"card h-100 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:s.title}),e.jsx("p",{className:"card-text text-muted small",children:s.description}),e.jsxs("div",{className:"mb-2",children:[e.jsx(I,{className:"me-2 text-primary"}),e.jsx("small",{children:T(s.scheduledTime)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(L,{className:"me-2 text-primary"}),e.jsxs("small",{children:[s.duration," minutes"]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{onClick:()=>D(s.meetingLink,s.title),className:"btn btn-sm btn-success flex-grow-1",children:[e.jsx(c,{className:"me-1"}),"Start"]}),e.jsx("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>M(s._id),children:e.jsx(B,{})})]})]})})},s._id))}),S&&e.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"},onClick:()=>r(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Schedule Meeting"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>r(!1)})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Title *"}),e.jsx("input",{type:"text",className:"form-control",value:t.title,onChange:s=>i({...t,title:s.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Description *"}),e.jsx("textarea",{className:"form-control",rows:"3",value:t.description,onChange:s=>i({...t,description:s.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Date & Time *"}),e.jsx("input",{type:"datetime-local",className:"form-control",value:t.scheduledTime,onChange:s=>i({...t,scheduledTime:s.target.value}),min:new Date().toISOString().slice(0,16),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Duration (minutes) *"}),e.jsx("input",{type:"number",className:"form-control",value:t.duration,onChange:s=>i({...t,duration:s.target.value}),min:"15",max:"480",required:!0})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>r(!1),disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Creating...":"Create Meeting"})]})]})]})})}),k&&e.jsx("div",{className:"modal show d-block",style:{backgroundColor:"rgba(0,0,0,0.7)"},children:e.jsx("div",{className:"modal-dialog modal-xl modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",style:{backgroundColor:"#1a1a1a"},children:[e.jsxs("div",{className:"modal-header border-0",style:{backgroundColor:"#2d2d2d"},children:[e.jsxs("h5",{className:"modal-title text-white",children:[e.jsx(c,{className:"me-2"}),p]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:F,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body p-0",style:{height:"70vh"},children:e.jsx("iframe",{src:C,title:p,className:"w-100 h-100",style:{border:"none"},allow:"camera; microphone; fullscreen; speaker; display-capture",allowFullScreen:!0})})]})})})]})}export{_ as default};
