import{d as F,r as c,b as p,B as u,j as e,c as v}from"./index-B7OZzBRK.js";import{T as U}from"./Table-C0LzT_QR.js";import{C as V}from"./Toast-C-pLTZpU.js";import{M as W}from"./Modal-BBnWcCLm.js";import"./ThemeProvider-mjo_KbZQ.js";function Q(){var y,w;document.title="CPMS | View Job Post";const{jobId:x}=F(),[a,A]=c.useState({}),[t,S]=c.useState(null),[D,$]=c.useState(!0),[C,f]=c.useState(!1),[k,m]=c.useState(""),[n,L]=c.useState({}),[j,M]=c.useState(!1),[g,_]=c.useState([]),N=async()=>{var s,l,o,i,h;try{const r=await p.get(`${u}/student/check-applied/${x}/${n.id}`);(s=r==null?void 0:r.data)!=null&&s.applied&&M((l=r==null?void 0:r.data)==null?void 0:l.applied)}catch(r){(i=(o=r==null?void 0:r.response)==null?void 0:o.data)!=null&&i.msg&&(m((h=response==null?void 0:response.data)==null?void 0:h.msg),f(!0)),console.log("error while fetching student applied or not => ",r)}};c.useEffect(()=>{const s=localStorage.getItem("token");p.get(`${u}/user/detail`,{headers:{Authorization:`Bearer ${s}`}}).then(l=>{L({id:l.data.id,email:l.data.email,role:l.data.role})}).catch(l=>{console.log("AddUserTable.jsx => ",l),m(l),f(!0)})},[]);const T=async()=>{var s,l,o;try{const i=await p.get(`${u}/tpo/job/${x}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});A(i.data)}catch(i){i.response&&((s=i==null?void 0:i.response.data)!=null&&s.msg?m(i.response.data.msg):m(i.message),f(!0),((o=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:o.msg)==="job data not found"&&navigate("../404")),console.log("Error while fetching details => ",i)}},E=async()=>{try{const s=await p.get(`${u}/company/company-data?companyId=${a.company}`);S(s.data.company)}catch(s){console.log("AddCompany error while fetching => ",s)}},[I,b]=c.useState(!1),[P,B]=c.useState(),J=()=>{b(!1)},R=()=>{B("Do you really want to apply this job? Make sure your profile is updated to lastest that increase placement chances."),b(!0)},z=async()=>{var s,l,o,i,h,r;try{const d=await p.put(`${u}/student/job/${x}/${n.id}`);(s=d==null?void 0:d.data)!=null&&s.msg&&(m((l=d==null?void 0:d.data)==null?void 0:l.msg),f(!0)),b(!1),N()}catch(d){b(!1),(i=(o=d==null?void 0:d.response)==null?void 0:o.data)!=null&&i.msg&&(m((r=(h=d==null?void 0:d.response)==null?void 0:h.data)==null?void 0:r.msg),f(!0)),console.log("error while fetching apply to job => ",d)}},H=async()=>{!x||(n==null?void 0:n.role)==="student"||await p.get(`${u}/tpo/job/applicants/${x}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(s=>{var l,o;(l=s==null?void 0:s.data)!=null&&l.msg?m(s.data.msg):_((o=s==null?void 0:s.data)==null?void 0:o.applicantsList)}).catch(s=>{var l,o;console.log(s),(o=(l=s==null?void 0:s.response)==null?void 0:l.data)!=null&&o.msg&&m(s.response.data.msg)})};return c.useEffect(()=>{(async()=>{try{await N(),a!=null&&a.company&&await E(),n.id&&await T(),x&&await H()}catch(l){console.error("Error during fetching and applying job:",l)}$(!1)})()},[n,a==null?void 0:a.company,x]),e.jsxs(e.Fragment,{children:[e.jsx(V,{show:C,onClose:()=>f(!1),message:k,delay:3e3,position:"bottom-end"}),D?e.jsx("div",{className:"flex justify-center h-72 items-center",children:e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-4xl text-indigo-600"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 text-white rounded-xl shadow-xl p-8 mb-6  ",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:a==null?void 0:a.jobTitle}),e.jsxs("div",{className:"flex items-center gap-3 text-lg",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-building"}),t==null?void 0:t.companyName]}),(t==null?void 0:t.companyLocation)&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-location-dot"}),(y=t==null?void 0:t.companyLocation)==null?void 0:y.split(",")[0]]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:["₹",a==null?void 0:a.salary," LPA"]}),e.jsx("div",{className:"text-sm opacity-90",children:"Annual CTC"})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 my-6 text-base max-sm:text-sm max-lg:grid-cols-1",children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-white/90 border-2 border-blue-200 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx("i",{className:"fa-solid fa-building text-blue-600 text-2xl"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Company Details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-800 mb-2",children:t==null?void 0:t.companyName}),e.jsx("p",{className:"text-gray-600 leading-relaxed text-justify",children:t==null?void 0:t.companyDescription})]}),(t==null?void 0:t.companyWebsite)&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-globe text-blue-600"}),"Website"]}),e.jsxs("a",{href:t==null?void 0:t.companyWebsite,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-medium no-underline flex items-center gap-1",children:["Visit ",e.jsx("i",{className:"fa-solid fa-arrow-up-right-from-square text-sm"})]})]}),(t==null?void 0:t.companyLocation)&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-map-marker-alt text-green-600"}),"Job Locations"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(w=t==null?void 0:t.companyLocation)==null?void 0:w.split(",").map((s,l)=>e.jsx("span",{className:"bg-green-100 text-green-700 py-1 px-3 rounded-full text-sm font-medium",children:s.trim()},l))})]}),(t==null?void 0:t.companyDifficulty)&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("span",{className:"font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-signal text-purple-600"}),"Difficulty Level"]}),e.jsx("span",{className:`py-1 px-4 rounded-full text-sm font-semibold ${(t==null?void 0:t.companyDifficulty)==="Easy"?"bg-green-100 text-green-700":(t==null?void 0:t.companyDifficulty)==="Moderate"?"bg-orange-100 text-orange-700":"bg-red-100 text-red-700"}`,children:t==null?void 0:t.companyDifficulty})]})]})]}),n.role!=="student"&&e.jsxs("div",{className:"space-y-4",children:[(n.role==="tpo_admin"||n.role==="management_admin")&&(g==null?void 0:g.length)>0&&e.jsx("div",{children:e.jsxs(v,{to:`/tpo/manage-applicants/${x}`,className:"inline-flex items-center gap-2 bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition-colors no-underline shadow-md",children:[e.jsx("i",{className:"fa-solid fa-users-gear"}),e.jsx("span",{className:"font-semibold",children:"Manage Applicants & Status"}),e.jsx("span",{className:"bg-white text-indigo-600 px-2 py-1 rounded-full text-sm font-bold",children:g.length})]})}),e.jsxs("div",{className:"bg-white/90 border-2 border-indigo-200 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-full",children:e.jsx("i",{className:"fa-solid fa-users text-indigo-600 text-2xl"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Applicants Applied"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(U,{striped:!0,hover:!0,size:"sm",className:"text-center",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10%"},children:"#"}),e.jsx("th",{style:{width:"20%"},children:"Name"}),e.jsx("th",{style:{width:"15%"},children:"Email"}),e.jsx("th",{style:{width:"20%"},children:"Current Round"}),e.jsx("th",{style:{width:"15%"},children:"Status"}),e.jsx("th",{style:{width:"20%"},children:"Applied On"})]})}),e.jsx("tbody",{children:(g==null?void 0:g.length)>0?e.jsx(e.Fragment,{children:g.map((s,l)=>{var o,i,h;return e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:(n.role==="tpo_admin"||n.role==="management_admin"||n.role==="superuser")&&e.jsx(v,{to:n.role==="tpo_admin"?`/tpo/user/${s.id}`:n.role==="management_admin"?`/management/user/${s.id}`:n.role==="superuser"?`/admin/user/${s.id}`:"#",target:"_blank",className:"text-blue-500 no-underline hover:text-blue-700",children:s.name})}),e.jsx("td",{children:s.email}),e.jsx("td",{children:((i=(o=s==null?void 0:s.currentRound)==null?void 0:o.charAt(0))==null?void 0:i.toUpperCase())+((h=s==null?void 0:s.currentRound)==null?void 0:h.slice(1))||"-"}),e.jsx("td",{children:s.applicationStatus?s.applicationStatus.charAt(0).toUpperCase()+s.applicationStatus.slice(1):s.status?s.status.charAt(0).toUpperCase()+s.status.slice(1):"Applied"}),e.jsx("td",{children:new Date(s.appliedAt).toLocaleString("en-IN")})]},l)})}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No Student Yet Applied!"})})})]})})]})]})]}),e.jsx("div",{className:"col-span-2 max-lg:col-span-1",children:e.jsxs("div",{className:"bg-white/90 border-2 border-purple-200 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx("i",{className:"fa-solid fa-briefcase text-purple-600 text-2xl"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Job Details"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border-l-4 border-purple-600",children:[e.jsxs("h4",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-file-lines text-purple-600"}),"Job Profile"]}),e.jsx("div",{className:"text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:a==null?void 0:a.jobDescription}})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-l-4 border-blue-600",children:[e.jsxs("h4",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-clipboard-check text-blue-600"}),"Eligibility Criteria"]}),e.jsx("div",{className:"text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:a==null?void 0:a.eligibility}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 max-sm:grid-cols-1",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border-l-4 border-green-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fa-solid fa-money-bill-wave text-green-600 text-xl"}),e.jsx("span",{className:"font-semibold text-gray-700",children:"Package"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["₹",a==null?void 0:a.salary," LPA"]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-red-50 to-orange-50 rounded-lg border-l-4 border-red-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fa-solid fa-calendar-xmark text-red-600 text-xl"}),e.jsx("span",{className:"font-semibold text-gray-700",children:"Deadline"})]}),e.jsx("div",{className:"text-lg font-bold text-red-600",children:new Date(a==null?void 0:a.applicationDeadline).toLocaleString("en-IN",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(j===!0||(n==null?void 0:n.role)!=="student")&&e.jsxs("div",{className:"p-4 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border-l-4 border-yellow-600",children:[e.jsxs("h4",{className:"font-bold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-circle-info text-yellow-600"}),"How to Apply?"]}),e.jsx("div",{className:"text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:a==null?void 0:a.howToApply}})]}),n.role==="student"&&e.jsx("div",{className:"flex justify-center py-4",children:(()=>{const s=(a==null?void 0:a.applicationDeadline)&&new Date>new Date(a.applicationDeadline);return j===!0?e.jsxs("div",{className:"px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-semibold rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-circle-check"}),"Already Applied"]}):s?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:"px-8 py-3 bg-gradient-to-r from-gray-400 to-gray-500 text-white font-semibold rounded-lg shadow-lg flex items-center gap-2 cursor-not-allowed opacity-75",children:[e.jsx("i",{className:"fa-solid fa-lock"}),"Application Closed"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Deadline has passed"})]}):e.jsxs("button",{onClick:R,className:"px-8 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-paper-plane"}),"Apply Now"]})})()})]})]})})]})]}),e.jsx(W,{show:I,close:J,header:"Confirmation",body:P,btn:"Apply",confirmAction:z})]})}export{Q as default};
